# Copilot Instructions - PowerShell Script Execution

## CRITICAL RULE: Never Paste PowerShell Directly to Terminal

### Problem
Pasting multi-line PowerShell scripts directly to `run_command_in_terminal` fails due to:
- Line ending issues
- Parsing problems with complex scripts
- User cancellation of complex commands
- Truncation of output

### Solution: Always Use Temporary Files

When executing multi-line PowerShell scripts:

1. **Write to temporary file**: Create a `.ps1` file
2. **Execute the file**: Run with `& .\filename.ps1` or `powershell -File filename.ps1`
3. **Clean up**: Remove the temp file after execution

### Example Pattern

```powershell
# WRONG - Don't do this:
run_command_in_terminal: |
  $complex = "script"
  foreach ($item in $items) {
    # Complex logic
  }

# RIGHT - Always do this:
# Step 1: Create temp file
create_file: temp_script_$(timestamp).ps1
  content: |
    $complex = "script"
    foreach ($item in $items) {
      # Complex logic
    }

# Step 2: Execute
run_command_in_terminal: .\temp_script_$(timestamp).ps1

# Step 3: Clean up
run_command_in_terminal: Remove-Item temp_script_$(timestamp).ps1
```

### When This Rule Applies

Use temporary file approach when:
- Script has more than 1-2 simple lines
- Script uses loops, conditionals, or complex logic
- Script processes variables or arrays
- Script needs to be reliable and repeatable

### When Simple Commands Are OK

Direct terminal execution is fine for:
- Single-line commands
- Simple `Get-Content`, `Test-Path`, etc.
- Quick status checks
- File operations like `Copy-Item`, `Remove-Item`

### Implementation Checklist

Before executing PowerShell:
- [ ] Is this more than 2 lines?
- [ ] Does it have loops/conditionals?
- [ ] Is reliability critical?

If YES to any: Use temporary file approach!

---

**Created**: January 2025  
**Purpose**: Prevent PowerShell execution failures  
**Priority**: CRITICAL - Follow this rule ALWAYS

